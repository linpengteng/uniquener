!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("crypto")):"function"==typeof define&&define.amd?define(["crypto"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).Uniquener=e(t.crypto)}(this,(function(t){"use strict";function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function r(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function n(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}function i(t,e,r){return(e=n(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var c=new Set([""]);return function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.algorithm,a=n.onlyUpdate,u=n.usedUniques,s=!1!==n.reduplicateExit,l=n.throwErrorHandler||function(t){},f=n.reduplicateHandler||function(t){return t},p=n.listenCacherHandler||function(t){},d=!0===s||"function"!=typeof n.reduplicateHandler,g=n.radix||16,m=n.random||"?",y=n.format||null,h="number"==typeof n.tryCount?n.tryCount:10;if(!0===a)try{return u instanceof Array&&u.forEach((function(t){return"string"==typeof t&&c.add(t.trim())})),u instanceof Set&&u.forEach((function(t){return"string"==typeof t&&c.add(t.trim())})),p(new Set(c)),""}catch(t){throw l(new Set(c)),new Error("[Options.listenCacherHandler] is Call Error")}if([2,8,10,16,26,36].includes(g)||(g=16),["?","*","#"].includes(m)||(m="?"),String(y)!==y&&(y=(y="????????-????-[1-5]???-[8-b]???-????????????").replace(/\?/g,m)),u instanceof Set)try{u.forEach((function(t){return"string"==typeof t&&c.add(t.trim())})),p(new Set(c))}catch(t){throw l(new Set(c)),new Error("[Options.listenCacherHandler] is Call Error")}if(u instanceof Array)try{u.forEach((function(t){return"string"==typeof t&&c.add(t.trim())})),p(new Set(c))}catch(t){throw l(new Set(c)),new Error("[Options.listenCacherHandler] is Call Error")}for(var b="",w=!0,v=!1,S=26===g?10:0,O=Array.from({length:36},(function(t,e){return e.toString(36)})),E=c.add.bind(c),A=function(e){var r=e.min,n=e.max,i=e.bytes;return"crypto.getRandomValues"===e.algorithm?i[t.getRandomValues(new Uint8Array(1))[0]%(n-r+1)+r|0]:i[Math.random()*(n-r+1)+r|0]},j=function(){var t=y.replace(/\[([^\]]+?)\]/g,(function(t,e){if("string"==typeof e){var r=new Set,n=r.add.bind(r),o=e.toLowerCase().split(/\s*,\s*/g).filter((function(t){return/^[\t-\r #\*\x2D\/-;=\?A-Za-z\|\xA0\u017F\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u212A\u3000\uFEFF]+$/i.test(t)})),a=function(t){return/^\s*[a-zA-Z0-9]\s*-\s*[a-zA-Z0-9]\s*$/.test(t)};if(b=e.trim(),/^\s*time\s*:\s*(YYYY|MM|DD|HH|mm|ss|iii|stamp|:|-|\||\/|\s)+\s*$/.test(b)){var c=new Date,u="".concat(c.getTime()),s="".concat(c.getFullYear()),l=c.getMonth()+1>9?"".concat(c.getMonth()+1):"0".concat(c.getMonth()+1),f=c.getMinutes()>9?"".concat(c.getMinutes()):"0".concat(c.getMinutes()),p=c.getSeconds()>9?"".concat(c.getSeconds()):"0".concat(c.getSeconds()),d=c.getMilliseconds()>99?"".concat(c.getMilliseconds()):c.getMilliseconds()>9?"0".concat(c.getMilliseconds()):"00".concat(c.getMilliseconds()),g=c.getHours()>9?"".concat(c.getHours()):"0".concat(c.getHours()),m=c.getDate()>9?"".concat(c.getDate()):"0".concat(c.getDate());return e.trim().replace(/^\s*time\s*:\s*/,"").replace(/stamp/g,u).replace(/YYYY/g,s).replace(/MM/g,l).replace(/DD/g,m).replace(/HH/g,g).replace(/mm/g,f).replace(/ss/g,p).replace(/iii/g,d).replace(/\s+/g," ")}var y=o.reduce((function(t,e){if(a(e.trim())){var r=e.trim().split(/\s*-\s*/)[0],i=e.trim().split(/\s*-\s*/)[1],o=O.indexOf(r.trim()),c=O.indexOf(i.trim()),u=Math.min(o,c),s=Math.max(o,c)+1;O.slice(u,s).forEach(n)}return a(e.trim())||n(e.trim()),t}),r),h=Array.from(y).filter((function(t){return!!t}));return A({bytes:h,algorithm:i,max:h.length-1,min:0})}var b;return t})),e=g-1,r=O.slice(S);if(b=o(t.toLowerCase()).filter((function(t){return/^[\t-\r #\*\x2D\/-;=\?A-Za-z\|\xA0\u017F\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u212A\u3000\uFEFF]+$/i.test(t)})).map((function(t){return t===m?A({bytes:r,algorithm:i,max:e,min:0}):t})).join("").trim(),!c.has(b))try{w=!1,E(b),p(new Set(c))}catch(t){throw l(new Set(c)),new Error("[Options.listenCacherHandler] is Call Error")}};w&&h-- >0;)j();if(w&&d)throw l(new Set(c)),new Error("[Uniquener generate unique] is Reduplicated");if(w&&!d)try{var M=f(n);return v=!0,e(r(r(r({},n),M),{reduplicateExit:!0}))}catch(t){throw!v&&l(new Set(c)),new Error(v?"[Uniquener generate unique] is Reduplicated":"[Options.reduplicateHandler] is Call Error")}return b}}));
