!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(e="undefined"!=typeof globalThis?globalThis:e||self).Uniquener=r()}(this,(function(){"use strict";const e=new Set([""]),r=(t={})=>{const n=t.onlyUpdate,i=t.usedUniques,o=!1!==t.reduplicateExit,a=t.throwErrorHandler||(e=>{}),s=t.reduplicateHandler||(e=>e),l=t.listenCacherHandler||(e=>{}),d=!0===o||"function"!=typeof t.reduplicateHandler;let c=t.radix||16,f=t.random||"?",u=t.format||null,h="number"==typeof t.tryCount?t.tryCount:10;if(!0===n)try{return i instanceof Array&&i.forEach((r=>"string"==typeof r&&e.add(r.trim()))),i instanceof Set&&i.forEach((r=>"string"==typeof r&&e.add(r.trim()))),l(new Set(e)),""}catch{throw a(new Set(e)),new Error("[Options.listenCacherHandler] is Call Error")}if([10,16,26,36].includes(c)||(c=16),["?","*","#"].includes(f)||(f="?"),String(u)!==u&&(u="????????-????-[1-5]???-[8-b]???-????????????",u=u.replace(/\?/g,f)),i instanceof Array)try{i.forEach((r=>"string"==typeof r&&e.add(r.trim()))),l(new Set(e))}catch{throw a(new Set(e)),new Error("[Options.listenCacherHandler] is Call Error")}if(i instanceof Set)try{i.forEach((r=>"string"==typeof r&&e.add(r.trim()))),l(new Set(e))}catch{throw a(new Set(e)),new Error("[Options.listenCacherHandler] is Call Error")}let p="",w=!0,m=!1;const y=Array.from({length:36},((e,r)=>r.toString(36))),E=e.add.bind(e);for(;w&&h-- >0;){if(p=[...u.replace(/\[([^\]]+?)\]/g,((e,r)=>{if("string"==typeof r){const e=new Set,t=e.add.bind(e),n=r.toLowerCase().split(/\s*,\s*/g).filter((e=>/^[a-zA-Z0-9\s\-*?#]+$/iu.test(e))),i=e=>/^\s*[a-zA-Z0-9]\s*-\s*[a-zA-Z0-9]\s*$/.test(e),o=n.reduce(((e,r)=>{if(i(r.trim())){const e=r.trim().split(/\s*-\s*/)[0],n=r.trim().split(/\s*-\s*/)[1],i=y.indexOf(e.trim()),o=y.indexOf(n.trim()),a=Math.min(i,o),s=Math.max(i,o)+1;y.slice(a,s).forEach(t)}return i(r.trim())||t(r.trim()),e}),e),a=Array.from(o).filter((e=>!!e));return a[Math.random()*a.length|0]||""}return e})).toLowerCase()].filter((e=>/^[a-zA-Z0-9\-*?#]+$/iu.test(e))).map((e=>e===f?y[Math.random()*c|0+(26===c?10:0)]:e)).join("").trim(),!e.has(p))try{w=!1,E(p),l(new Set(e))}catch{throw a(new Set(e)),new Error("[Options.listenCacherHandler] is Call Error")}}if(w&&d)throw a(new Set(e)),new Error("[Uniquener generate unique] is Reduplicated");if(w&&!d)try{const e=s(t),n={reduplicateExit:!0};return m=!0,r({...t,...e,...n})}catch{throw!m&&a(new Set(e)),new Error(m?"[Uniquener generate unique] is Reduplicated":"[Options.reduplicateHandler] is Call Error")}return p};return r}));
