!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(e="undefined"!=typeof globalThis?globalThis:e||self).Uniquener=r()}(this,(function(){"use strict";const e=new Set([""]),r=(t={})=>{const n=t.onlyUpdate,i=t.usedUniques,a=!1!==t.reduplicateExit,o=t.throwErrorHandler||(e=>{}),s=t.reduplicateHandler||(e=>e),l=t.listenCacherHandler||(e=>{}),d=!0===a||"function"!=typeof t.reduplicateHandler;let c=t.radix||16,f=t.random||"?",u=t.format||null,h="number"==typeof t.tryCount?t.tryCount:10;if(!0===n)try{return i instanceof Array&&i.forEach((r=>"string"==typeof r&&e.add(r.trim()))),i instanceof Set&&i.forEach((r=>"string"==typeof r&&e.add(r.trim()))),l(new Set(e)),""}catch{throw o(new Set(e)),new Error("[Options.listenCacherHandler] is Call Error")}if([10,16,26,36].includes(c)||(c=16),["?","*","#"].includes(f)||(f="?"),String(u)!==u&&(u="????????-????-[1-5]???-[8-b]???-????????????",u=u.replace(/\?/g,f)),i instanceof Array)try{i.forEach((r=>"string"==typeof r&&e.add(r.trim()))),l(new Set(e))}catch{throw o(new Set(e)),new Error("[Options.listenCacherHandler] is Call Error")}if(i instanceof Set)try{i.forEach((r=>"string"==typeof r&&e.add(r.trim()))),l(new Set(e))}catch{throw o(new Set(e)),new Error("[Options.listenCacherHandler] is Call Error")}let p="",w=!0,y=!1;const m=Array.from({length:36},((e,r)=>r.toString(36))),E=e.add.bind(e);for(;w&&h-- >0;){if(p=[...u.replace(/\[([^\]]+?)\]/g,((e,r)=>{if("string"==typeof r){const e=new Set,t=e.add.bind(e),n=r.toLowerCase().split(/\s*,\s*|\s+/g).filter((e=>/^[a-zA-Z0-9\-*?#]+$/iu.test(e))),i=e=>/^[a-zA-Z0-9]-[a-zA-Z0-9]$/.test(e),a=n.reduce(((e,r)=>{if(i(r)){const e=r.split("-")[0],n=r.split("-")[1],i=m.indexOf(e),a=m.indexOf(n),o=Math.min(i,a),s=Math.max(i,a)+1;m.slice(o,s).forEach(t)}return i(r)||t(r),e}),e),o=Array.from(a).filter((e=>!!e));return o[Math.random()*o.length|0]||""}return e})).toLowerCase()].filter((e=>/^[a-zA-Z0-9\-*?#]+$/iu.test(e))).map((e=>e===f?26!==c?m[Math.random()*c|0]:m[Math.random()*c|10]:e)).join("").trim(),!e.has(p))try{w=!1,E(p),l(new Set(e))}catch{throw o(new Set(e)),new Error("[Options.listenCacherHandler] is Call Error")}}if(w&&d)throw o(new Set(e)),new Error("[Uniquener generate unique] is Reduplicated");if(w&&!d)try{const e=s(t),n={reduplicateExit:!0};return y=!0,r({...t,...e,...n})}catch{throw!y&&o(new Set(e)),new Error(y?"[Uniquener generate unique] is Reduplicated":"[Options.reduplicateHandler] is Call Error")}return p};return r}));
