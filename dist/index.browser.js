!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Uniquener=t()}(this,(function(){"use strict";const e=new Set([""]),t=(r={})=>{const n=r.onlyUpdate,i=r.usedUniques,s=!1!==r.reduplicateExit,a=r.throwErrorHandler||(e=>{}),o=r.reduplicateHandler||(e=>e),l=r.listenCacherHandler||(e=>{}),c=!0===s||"function"!=typeof r.reduplicateHandler;let d=r.radix||16,u=r.random||"?",f=r.format||null,g="number"==typeof r.tryCount?r.tryCount:10;if(!0===n)try{return i instanceof Array&&i.forEach((t=>"string"==typeof t&&e.add(t.trim()))),i instanceof Set&&i.forEach((t=>"string"==typeof t&&e.add(t.trim()))),l(new Set(e)),""}catch{throw a(new Set(e)),new Error("[Options.listenCacherHandler] is Call Error")}if([10,16,26,36].includes(d)||(d=16),["?","*","#"].includes(u)||(u="?"),String(f)!==f&&(f="????????-????-[1-5]???-[8-b]???-????????????",f=f.replace(/\?/g,u)),i instanceof Array)try{i.forEach((t=>"string"==typeof t&&e.add(t.trim()))),l(new Set(e))}catch{throw a(new Set(e)),new Error("[Options.listenCacherHandler] is Call Error")}if(i instanceof Set)try{i.forEach((t=>"string"==typeof t&&e.add(t.trim()))),l(new Set(e))}catch{throw a(new Set(e)),new Error("[Options.listenCacherHandler] is Call Error")}let p="",m=!0,h=!1;const w=Array.from({length:36},((e,t)=>t.toString(36))),y=e.add.bind(e);for(;m&&g-- >0;){if(p=[...f.replace(/\[([^\]]+?)\]/g,((e,t)=>{if("string"==typeof t){const e=new Set,r=e.add.bind(e),n=t.toLowerCase().split(/\s*,\s*/g).filter((e=>/^[a-zA-Z0-9\s/|\-*?#=:;]+$/iu.test(e))),i=e=>/^\s*[a-zA-Z0-9]\s*-\s*[a-zA-Z0-9]\s*$/.test(e);if((e=>/^\s*time\s*:\s*(YYYY|MM|DD|HH|mm|ss|iii|stamp|:|-|\||\/|\s)+\s*$/.test(e))(t.trim())){const e=new Date,r=`${e.getTime()}`,n=`${e.getFullYear()}`,i=e.getMonth()+1>9?`${e.getMonth()+1}`:`0${e.getMonth()+1}`,s=e.getMinutes()>9?`${e.getMinutes()}`:`0${e.getMinutes()}`,a=e.getSeconds()>9?`${e.getSeconds()}`:`0${e.getSeconds()}`,o=e.getMilliseconds()>99?`${e.getMilliseconds()}`:e.getMilliseconds()>9?`0${e.getMilliseconds()}`:`00${e.getMilliseconds()}`,l=e.getHours()>9?`${e.getHours()}`:`0${e.getHours()}`,c=e.getDate()>9?`${e.getDate()}`:`0${e.getDate()}`;return t.trim().replace(/^\s*time\s*:\s*/,"").replace(/stamp/g,r).replace(/YYYY/g,n).replace(/MM/g,i).replace(/DD/g,c).replace(/HH/g,l).replace(/mm/g,s).replace(/ss/g,a).replace(/iii/g,o).replace(/\s+/g," ")}const s=n.reduce(((e,t)=>{if(i(t.trim())){const e=t.trim().split(/\s*-\s*/)[0],n=t.trim().split(/\s*-\s*/)[1],i=w.indexOf(e.trim()),s=w.indexOf(n.trim()),a=Math.min(i,s),o=Math.max(i,s)+1;w.slice(a,o).forEach(r)}return i(t.trim())||r(t.trim()),e}),e),a=Array.from(s).filter((e=>!!e));return a[Math.random()*a.length|0]||""}return e})).toLowerCase()].filter((e=>/^[a-zA-Z0-9\s/|\-*?#=:;]+$/iu.test(e))).map((e=>e===u?w[Math.random()*d|0+(26===d?10:0)]:e)).join("").trim(),!e.has(p))try{m=!1,y(p),l(new Set(e))}catch{throw a(new Set(e)),new Error("[Options.listenCacherHandler] is Call Error")}}if(m&&c)throw a(new Set(e)),new Error("[Uniquener generate unique] is Reduplicated");if(m&&!c)try{const e=o(r),n={reduplicateExit:!0};return h=!0,t({...r,...e,...n})}catch{throw!h&&a(new Set(e)),new Error(h?"[Uniquener generate unique] is Reduplicated":"[Options.reduplicateHandler] is Call Error")}return p};return t}));
