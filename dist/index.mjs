const e=new Set,r=(t={})=>{const n=t.onlyUpdate,a=t.usedUniques,i=!1!==t.reduplicateExit,o=t.throwErrorHandler||(e=>{}),l=t.reduplicateHandler||(e=>e),s=t.listenCacherHandler||(e=>{}),c=!0===i||"function"!=typeof t.reduplicateHandler;let d=t.radix||16,f=t.random||"?",u=t.format||null,h="number"==typeof t.tryCount?t.tryCount:10;if(!0===n)try{return a instanceof Array&&a.forEach((r=>"string"==typeof r&&e.add(r))),a instanceof Set&&a.forEach((r=>"string"==typeof r&&e.add(r))),s(new Set(e)),""}catch{throw o(new Set(e)),new Error("[Options.listenCacherHandler] is Call Error")}if([10,16,36].includes(d)||(d=16),["?","*","#"].includes(f)||(f="?"),String(u)!==u&&(u="????????-????-[1-5]???-[8-b]???-????????????",u=u.replace(/\?/g,f)),a instanceof Array)try{a.forEach((r=>"string"==typeof r&&e.add(r))),s(new Set(e))}catch{throw o(new Set(e)),new Error("[Options.listenCacherHandler] is Call Error")}if(a instanceof Set)try{a.forEach((r=>"string"==typeof r&&e.add(r))),s(new Set(e))}catch{throw o(new Set(e)),new Error("[Options.listenCacherHandler] is Call Error")}let p="",w=!0,y=!1;const E=Array.from({length:36},((e,r)=>r.toString(36))),S=e.add.bind(e);for(;w&&h-- >0;){if(p=[...u.replace(/\[([^\]]+?)\]/g,((e,r)=>{if("string"==typeof r){const e=new Set,t=e.add.bind(e),n=r.toLowerCase().split(/\s*,\s*|\s+/g).filter((e=>/^[a-zA-Z0-9\-*?#]+$/iu.test(e))),a=e=>/^[a-zA-Z0-9]-[a-zA-Z0-9]$/.test(e),i=n.reduce(((e,r)=>{if(a(r)){const e=r.split("-")[0],n=r.split("-")[1],a=E.indexOf(e),i=E.indexOf(n),o=Math.min(a,i),l=Math.max(a,i)+1;E.slice(o,l).forEach(t)}return a(r)||t(r),e}),e),o=Array.from(i).filter((e=>!!e));return o[Math.random()*o.length|0]||""}return e})).toLowerCase()].filter((e=>/^[a-zA-Z0-9\-*?#]+$/iu.test(e))).map((e=>e===f?E[Math.random()*d|0]:e)).join(""),!e.has(p))try{w=!1,S(p),s(new Set(e))}catch{throw o(new Set(e)),new Error("[Options.listenCacherHandler] is Call Error")}}if(w&&c)throw o(new Set(e)),new Error("[Uniquener generate unique] is Reduplicated");if(w&&!c)try{const e=l(t),n={reduplicateExit:!0};return y=!0,r({...t,...e,...n})}catch{throw!y&&o(new Set(e)),new Error(y?"[Uniquener generate unique] is Reduplicated":"[Options.reduplicateHandler] is Call Error")}return p};export{r as default};
